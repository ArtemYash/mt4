<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  <title>Trade Permission</title>
  <meta name="keywords" content="" />
  <link type="text/css" href="default.css" rel="stylesheet" />






</head>

<body style="background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;">



<table width="100%" border="0" cellpadding="0" cellspacing="0" style="margin:0; background: #7F90A5 url('gradient_header.png') repeat-x left top; border-bottom: 3px solid #DBE0E5;">
  <tr>
    <td valign="middle">
      <table style="margin: 10px 0" width="100%"  border="0" cellspacing="0" cellpadding="0">
        <tr valign="middle">
          <td class="nav">
<a class="h_m" href="index.htm">          MQL4/5 Reference </a> / <a class="h_m" href="runtime.htm"> MQL4 programs </a>/ Trade Permission
          </td>
          <td align="right" style="white-space: nowrap; padding: 0 10px;">
          <a href="running.htm"><img style="vertical-align:middle;" src="previous.png" alt="?????" width="27" height="27" border=0></a><!--
       --><a href="event_fire.htm"><img style="vertical-align:middle;margin-left: 7px;" src="next.png" alt="??????" width="27" height="27" border="0"></a>
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>



<div id="help">
<p class="p_H1"><span class="f_H1">Trade Permission</span></p>
<p class="p_H2"><span class="f_H2">Trade Automation</span></p>
<p class="p_Text"><span class="f_Text"><MQL4/5 language> provides a special group of <a href="trading.htm" class="topiclink">trade functions</a> designed for developing automated trading systems. Programs developed for automated trading with no human intervention are called Expert Advisors or trading robots. In order to create an Expert Advisor in MetaEditor, launch MQL4 Wizard and select the option &quot;</span><span class="f_li">Expert Advisor (template)&quot;. It allows you to create a template with ready-made <a href="events.htm" class="topiclink">event handling functions</a> that should be supplemented with all necessary functionality by means of programming.</span></p>
<p class="p_Text" style="text-align: center;"><img class="help" alt="MQL4_Wizard" width="532" height="399" style="margin:0px auto 0px auto;width:532px;height:399px;border:none" src="mql4_wizard.png"/></p>
<p class="p_Text"><span class="f_Text">Trading functions can work only in Expert Advisors and scripts. Trading is not allowed for indicators.</span></p>
<p class="p_H2"><span class="f_H2">Checking for Permission to Perform Automated Trading</span></p>
<p class="p_Text"><span class="f_Text">In order to develop a reliable Expert Advisor capable of working without human intervention, it is necessary to arrange a set of important checks. First, we should programmatically check if trading is allowed at all. This is a basic check that is indispensable when developing any automated system.</span></p>
<p class="p_H3"><span class="f_H3">Checking for permission to perform automated trading in the terminal</span></p>
<p class="p_Text"><span class="f_Text">The terminal settings provide you with an ability to allow or forbid automated trading for all programs.</span></p>
<p class="p_Text" style="text-align: center;"><img class="help" alt="TERMINAL_TRADE_ALLOWED" width="591" height="393" style="margin:0px auto 0px auto;width:591px;height:393px;border:none" src="terminal_trade_allowed.png"/></p>
<p class="p_Text"><span class="f_Text">You can switch automated trading option right on the terminal&#39;s Standard panel: &nbsp;</span></p>
<ul style="text-indent:0px; padding-left:0; margin-top:0; margin-bottom:0; margin-left: 30px;list-style-position:outside; list-style-type:disc">
<li style="text-align: justify; padding: 0px 0px 0px 0px; margin-top: 3px; margin-right: 17px; margin-bottom: 3px;"><img class="help" alt="AutoTrading_enabled" width="97" height="23" style="margin:0;width:97px;height:23px;border:none" src="autotrading_enabled.png"/><span class="f_li">– automated trading enabled, trading functions in launched applications are allowed for use.</span></li>
<li style="text-align: justify; padding: 0px 0px 0px 0px; margin-top: 3px; margin-right: 17px; margin-bottom: 3px;"><img class="help" alt="AutoTrading_disabled" width="97" height="23" style="margin:0;width:97px;height:23px;border:none" src="autotrading_disabled.png"/><span class="f_li"> – automated trading disabled, </span><span class="f_Text">running applications are unable to execute trading functions. </span></li>
</ul>
<p class="p_Text"><span class="f_Text">Sample check:</span></p>
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; padding:3px;"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">&nbsp;(!</span><span class="f_CodeExample" style="color: #0000ff;">TerminalInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">TERMINAL_TRADE_ALLOWED</span><span class="f_CodeExample">))&nbsp;</span>
<br><span class="f_CodeExample" style="color: #0000ff;">&nbsp;&nbsp;&nbsp;Alert</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;Check&nbsp;if&nbsp;automated&nbsp;trading&nbsp;is&nbsp;allowed&nbsp;in&nbsp;the&nbsp;terminal&nbsp;settings!&quot;</span><span class="f_CodeExample">);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_H3"><span class="f_H3">Checking if trading is allowed for a certain running Expert Advisor/script</span></p>
<p class="p_Text"><span class="f_Text">You can allow or forbid automated trading for a certain program when launching it. To do this, use the special check box in the program properties.</span></p>
<p class="p_Text" style="text-align: center;"><img class="help" alt="MQL_TRADE_ALLOWED" width="619" height="309" style="margin:0px auto 0px auto;width:619px;height:309px;border:none" src="mql_trade_allowed.png"/></p>
<p class="p_Text"><span class="f_Text">Sample check:</span></p>
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; padding:3px;"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #0000ff;">TerminalInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">TERMINAL_TRADE_ALLOWED</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Alert</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;Check&nbsp;if&nbsp;automated&nbsp;trading&nbsp;is&nbsp;allowed&nbsp;in&nbsp;the&nbsp;terminal&nbsp;settings!&quot;</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">else</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #0000ff;">MQLInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">MQL_TRADE_ALLOWED</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Alert</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;Automated&nbsp;trading&nbsp;is&nbsp;forbidden&nbsp;in&nbsp;the&nbsp;program&nbsp;settings&nbsp;for&nbsp;&quot;</span><span class="f_CodeExample">,</span><span class="f_CodeExample" style="color: #0000ff;">__FILE__</span><span class="f_CodeExample">);</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">&nbsp;</span></p>
<p class="p_H3"><span class="f_H3">Checking if trading is allowed for any Expert Advisors/scripts for the current account</span></p>
<p class="p_Text"><span class="f_Text">Automated trading can be disabled at the trade server side. Sample check:</span></p>
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; padding:3px;"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #0000ff;">AccountInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">ACCOUNT_TRADE_EXPERT</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Alert</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;Automated&nbsp;trading&nbsp;is&nbsp;forbidden&nbsp;for&nbsp;the&nbsp;account&nbsp;&quot;</span><span class="f_CodeExample">,</span><span class="f_CodeExample" style="color: #0000ff;">AccountInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">ACCOUNT_LOGIN</span><span class="f_CodeExample">),</span>
<br><span class="f_CodeExample" style="color: #008080;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;&nbsp;at&nbsp;the&nbsp;trade&nbsp;server&nbsp;side&quot;</span><span class="f_CodeExample">);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">If automated trading is disabled for a trading account, trading operations of Expert Advisors/scripts are not executed.</span></p>
<p class="p_H3"><span class="f_H3">Checking if trading is allowed for the current account</span></p>
<p class="p_Text"><span class="f_Text">In some cases, any trading operations are disabled for a certain trading account – neither manual nor automated trading can be performed. Sample check when an investor password has been used to connect to a trading account:</span></p>
<div style="text-align: left; text-indent: 0px; line-height: 1.0; page-break-inside: avoid; border-color: #b3b3b3; border-style: solid; border-width: thin; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;"><table cellspacing="0" cellpadding="3" border="0" style="text-align: justify;border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; padding:3px;"><p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">if</span><span class="f_CodeExample">(!</span><span class="f_CodeExample" style="color: #0000ff;">AccountInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">ACCOUNT_TRADE_ALLOWED</span><span class="f_CodeExample">))</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #0000ff;">Comment</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #008080;">&quot;Trading&nbsp;is&nbsp;forbidden&nbsp;for&nbsp;the&nbsp;account&nbsp;&quot;</span><span class="f_CodeExample">,</span><span class="f_CodeExample" style="color: #0000ff;">AccountInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">ACCOUNT_LOGIN</span><span class="f_CodeExample">),</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;.\n&nbsp;Perhaps&nbsp;an&nbsp;investor&nbsp;password&nbsp;has&nbsp;been&nbsp;used&nbsp;to&nbsp;connect&nbsp;to&nbsp;the&nbsp;trading&nbsp;account.&quot;</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;\n&nbsp;Check&nbsp;the&nbsp;terminal&nbsp;journal&nbsp;for&nbsp;the&nbsp;following&nbsp;entry:&quot;</span><span class="f_CodeExample">,</span>
<br><span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="f_CodeExample" style="color: #008080;">&quot;\n\&#39;&quot;</span><span class="f_CodeExample">,</span><span class="f_CodeExample" style="color: #0000ff;">AccountInfoInteger</span><span class="f_CodeExample">(</span><span class="f_CodeExample" style="color: #0000ff;">ACCOUNT_LOGIN</span><span class="f_CodeExample">),</span><span class="f_CodeExample" style="color: #008080;">&quot;\&#39;:&nbsp;trading&nbsp;has&nbsp;been&nbsp;disabled&nbsp;-&nbsp;investor&nbsp;mode.&quot;</span><span class="f_CodeExample">);</span></p>
</td>
</tr>
</table>
</div>
<p class="p_Text"><span class="f_Text">AccountInfoInteger(ACCOUNT_TRADE_ALLOWED) may return </span><span class="f_Text" style="font-weight: bold;">false</span><span class="f_Text"> in the following cases:</span></p>
<ul style="text-indent:0px; padding-left:0; margin-top:0; margin-bottom:0; margin-left: 30px;list-style-position:outside; list-style-type:disc">
<li style="text-align: justify; padding: 0px 0px 0px 0px; margin-top: 3px; margin-right: 17px; margin-bottom: 3px;"><span class="f_li">no connection to the trade server. That can be checked using TerminalInfoInteger(TERMINAL_CONNECTED));</span></li>
<li style="text-align: justify; padding: 0px 0px 0px 0px; margin-top: 3px; margin-right: 17px; margin-bottom: 3px;"><span class="f_li">trading account switched to read-only mode (sent to the archive);</span></li>
<li style="text-align: justify; padding: 0px 0px 0px 0px; margin-top: 3px; margin-right: 17px; margin-bottom: 3px;"><span class="f_li">trading on the account is disabled at the trade server side;</span></li>
<li style="text-align: justify; padding: 0px 0px 0px 0px; margin-top: 3px; margin-right: 17px; margin-bottom: 3px;"><span class="f_li">connection to a trading account has been performed in Investor mode.</span></li>
</ul>
<p class="p_li"><span class="f_li">&nbsp;</span></p>
<p class="p_BoldTitles"><span class="f_BoldTitles">See also</span></p>
<p class="p_SeeAlso"><span class="f_SeeAlso"><a href="terminalstatus.htm" class="topiclink">Client Terminal Properties</a>, <a href="accountinformation.htm" class="topiclink">Account Properties</a>, <a href="mql4_programm_info.htm" class="topiclink">Properties of a Running MQL4 Program</a></span></p>

<br>
</div>
</body>
</html>
